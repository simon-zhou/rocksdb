Write batch (coalsecing) to improve throughput.

Version + version edit = new version
Each version includes a set of files for each level.
